#___________________________________________________________________________________
#### Importar seu conjunto de dados para o R
## Opção 1: via Google Drive
LinkAcessoDrive<-"https://docs.google.com/spreadsheets/d/e/2PACX-1vTNICAmWcF6tGHRhXif7_8uG-dBLQza9zi9kCte3XFEbx9kv9m4nR0NG9YmbR45sHHp01CSvFRIyHl9/pub?output=csv"; tabela1<-read.csv(url(LinkAcessoDrive), sep = ",",dec = "."); rm(LinkAcessoDrive); tabela1$Sexo<-as.factor(tabela1$Sexo)
View(tabela1)
View(tabela1)
#_________________________________________________________________________
### Pegunta 1. Existe diferença na quantidade Plaquetas em relação ao estado? (Ex. ANOVA de uma entrada)
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
hist(tabela1$Plaquetas)
boxplot(tabela1$Plaquetas~tabela1$UF)
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$UF)
# Observa os resultados
summary(modelo)
View(tabela1)
#_________________________________________________________________________
###  Pegunta 2. Existe diferença na quantidade Plaquetas em relação a categoria de idade? (Ex. teste de Tukey)
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
boxplot(tabela1$Plaquetas~tabela1$CategoriaIdade) # Para fins didaticos vamos assumir que está tudo bem
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$UF)
aov(tabela1$Plaquetas~tabela1$UF)
# Observa os resultados
summary(modelo)
boxplot(tabela1$Plaquetas~tabela1$UF)
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$UF)
# Observa os resultados
summary(modelo)
#_________________________________________________________________________
###  Pegunta 2. Existe diferença na quantidade Plaquetas em relação a categoria de idade? (Ex. teste de Tukey)
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
boxplot(tabela1$Plaquetas~tabela1$CategoriaIdade) # Para fins didaticos vamos assumir que está tudo bem
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$CategoriaIdade)
# Observa os resultados
summary(modelo)
# Pos-teste
TukeyHSD(modelo)
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$CategoriaIdade)
# Observa os resultados
summary(modelo)
# Pos-teste
TukeyHSD(modelo)
#_________________________________________________________________________
###   Pegunta 3. Existe diferença na quantidade testosterona em relação a categoria de idade? (Ex. Teste não-parametrico)
# Nesse exemplo vamos usar apenas os dados de pacientes do sexo masculino, dado conhecida influencia do sexo na testosterona
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
tabelaCortada<-subset(tabela1, tabela1$Sexo=="M")
View(tabelaCortada)
hist(tabelaCortada$Testosterona)
boxplot(tabelaCortada$Testosterona~tabelaCortada$CategoriaIdade)
# Executa a análise
kruskal.test(Testosterona ~ CategoriaIdade, data = tabelaCortada)
# Pos teste
install.packages("rstatix")
library(rstatix)
dunn_test(Testosterona ~ CategoriaIdade, data = tabelaCortada, p.adjust.method = "bonferroni")
# Executa a análise
kruskal.test(Testosterona ~ CategoriaIdade, data = tabelaCortada)
# Executa a análise
kruskal.test(Testosterona ~ CategoriaIdade, data = tabelaCortada)
# Executa a análise
kruskal.test(Testosterona ~ CategoriaIdade, data = tabelaCortada)
library(rstatix)
dunn_test(Testosterona ~ CategoriaIdade, data = tabelaCortada, p.adjust.method = "bonferroni")
#_________________________________________________________________________
###  Pegunta 2. Existe diferença na quantidade Plaquetas em relação a categoria de idade? (Ex. teste de Tukey)
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
boxplot(tabela1$Plaquetas~tabela1$CategoriaIdade) # Para fins didaticos vamos assumir que está tudo bem
# Executa a análise
modelo<-aov(tabela1$Plaquetas~tabela1$CategoriaIdade)
# Observa os resultados
summary(modelo)
# Avaliar pressupostos (normalidade, variancias iguais, outliers)
tabelaCortada<-subset(tabela1, tabela1$Sexo=="M")
hist(tabelaCortada$Testosterona)
boxplot(tabelaCortada$Testosterona~tabelaCortada$CategoriaIdade)
#_________________________________________________________________________
# Pegunta 4. Existe diferença na glicose em relação a idade e registro de infecção por COVID? (Ex. ANOVA duas entradas)
# Avaliar normalidade e homogenidade de variâncias
hist(tabela1$Glicose)
boxplot(tabela1$Glicose~tabela1$CategoriaIdade:tabela1$Covid19PCR)
# Executa a análise
modelo<-aov(tabela1$Glicose~tabela1$CategoriaIdade+tabela1$Covid19PCR)
# Observa os resultados
summary(modelo)
# Pós teste
TukeyHSD(modelo)
#_________________________________________________________________________
# Grafico de barras
# Veja a media de glicose nos grupos
with(tabela1, tapply(Glicose, CategoriaIdade, mean)) # Media
with(tabela1, tapply(Glicose, CategoriaIdade, sd)) # Desvio
# CURSO: ESTATÍSTICA PARA SAÚDE COLETIVA
# TUTORIAL: Tutorial para construção de graficos de barra com intervalo de confiança
install.packages("psych"); install.packages("ggplot2")
library(psych); library(ggplot2)
####### Grafico A - Grafico para comparar grupos com dados de 1 unica variavel
# Grafico de quantidade de testosterona dependendo do grupo de idade
# Importar tabela
TabelaDados<-subset(tabela1, tabela1$Sexo=="M")
str(TabelaDados)
TabelaDados$CategoriaIdade<-factor(TabelaDados$CategoriaIdade)
nomes_grupos<-levels(TabelaDados$CategoriaIdade)
cell1<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[1])
cell2<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[2])
cell3<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[3])
cell4<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[4])
cell5<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[5])
a <- describe(cell1$Testosterona)
b <- describe(cell2$Testosterona)
c <- describe(cell3$Testosterona)
d <- describe(cell4$Testosterona)
e <- describe(cell5$Testosterona)
DadoParaGrafico <- data.frame(CategoriaIdade = nomes_grupos,
TestosteronaMedia = c(a$mean,b$mean,c$mean,d$mean,e$mean),
Erros = c(a$se,b$se,c$se,d$se,e$se))
# Opção 1 - Gráfico simples
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = CategoriaIdade, y=TestosteronaMedia, color = CategoriaIdade))
SeuGrafico <- SeuGrafico + geom_errorbar(aes(ymin=TestosteronaMedia-1.96*Erros, ymax=TestosteronaMedia+1.96*Erros), width=.5,
position=position_dodge(.9))
SeuGrafico
# Opção 2- Gráfico de barras
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = CategoriaIdade, y=TestosteronaMedia))
SeuGrafico <- SeuGrafico + geom_bar(stat="identity", position = position_dodge()) +
geom_errorbar(aes(ymin=TestosteronaMedia-1.96*Erros, ymax=TestosteronaMedia+1.96*Erros), width=.2,
position=position_dodge(.9)) +
labs(x="Grupo de idade", y = "Quantidade de testosterona")+   theme_minimal()
SeuGrafico
####### Grafico B - Grafico para comparar grupos partindo de dados de 2 variáveis
# Importar tabela
TabelaDados<-tabela1
TabelaDados$Covid19PCR<-factor(TabelaDados$Covid19PCR)
TabelaDados$Sexo<-factor(TabelaDados$Sexo)
str(TabelaDados)
CatCovid19PCR<-levels(TabelaDados$Covid19PCR)
CatSexo<-levels(TabelaDados$Sexo)
cell1<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[1]&TabelaDados$Sexo==CatSexo[1])
cell2<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[2]&TabelaDados$Sexo==CatSexo[1])
cell3<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[1]&TabelaDados$Sexo==CatSexo[2])
cell4<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[2]&TabelaDados$Sexo==CatSexo[2])
a <- describe(cell1$Glicose)
b <- describe(cell2$Glicose)
c <- describe(cell3$Glicose)
d <- describe(cell4$Glicose)
DadoParaGrafico <- data.frame(Covid19PCR = c(CatCovid19PCR[1],CatCovid19PCR[2],CatCovid19PCR[1],CatCovid19PCR[2]),
Sexo = c(CatSexo[1],CatSexo[1],CatSexo[2],CatSexo[2]),
Media = c(a$mean,b$mean,c$mean,d$mean),
Erros = c(a$se,b$se,c$se,d$se))
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = Covid19PCR, y=Media, fill =Sexo ))
SeuGrafico <- SeuGrafico + geom_bar(stat="identity", position = position_dodge()) +
geom_errorbar(aes(ymin=Media-1.96*Erros, ymax=Media+1.96*Erros), width=.65,
position=position_dodge(.9)) +
labs(x="Sexo", y = "Glicose ")+
scale_fill_brewer(palette="Paired") + theme_minimal()
SeuGrafico
# Obs
# scale_fill_brewer(palette="Green") Define as cores das barras
# theme_minimal deixa o fundo branco
####### Grafico A - Grafico para comparar grupos com dados de 1 unica variavel
# Grafico de quantidade de testosterona dependendo do grupo de idade
# Importar tabela
TabelaDados<-subset(tabela1, tabela1$Sexo=="M")
library(psych); library(ggplot2)
####### Grafico A - Grafico para comparar grupos com dados de 1 unica variavel
# Grafico de quantidade de testosterona dependendo do grupo de idade
# Importar tabela
TabelaDados<-subset(tabela1, tabela1$Sexo=="M")
str(TabelaDados)
TabelaDados$CategoriaIdade<-factor(TabelaDados$CategoriaIdade)
nomes_grupos<-levels(TabelaDados$CategoriaIdade)
cell1<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[1])
cell2<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[2])
cell3<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[3])
cell4<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[4])
cell5<- subset(TabelaDados, TabelaDados$CategoriaIdade==nomes_grupos[5])
a <- describe(cell1$Testosterona)
b <- describe(cell2$Testosterona)
c <- describe(cell3$Testosterona)
d <- describe(cell4$Testosterona)
e <- describe(cell5$Testosterona)
DadoParaGrafico <- data.frame(CategoriaIdade = nomes_grupos,
TestosteronaMedia = c(a$mean,b$mean,c$mean,d$mean,e$mean),
Erros = c(a$se,b$se,c$se,d$se,e$se))
# Opção 1 - Gráfico simples
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = CategoriaIdade, y=TestosteronaMedia, color = CategoriaIdade))
SeuGrafico <- SeuGrafico + geom_errorbar(aes(ymin=TestosteronaMedia-1.96*Erros, ymax=TestosteronaMedia+1.96*Erros), width=.5,
position=position_dodge(.9))
SeuGrafico
# Opção 2- Gráfico de barras
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = CategoriaIdade, y=TestosteronaMedia))
SeuGrafico <- SeuGrafico + geom_bar(stat="identity", position = position_dodge()) +
geom_errorbar(aes(ymin=TestosteronaMedia-1.96*Erros, ymax=TestosteronaMedia+1.96*Erros), width=.2,
position=position_dodge(.9)) +
labs(x="Grupo de idade", y = "Quantidade de testosterona")+   theme_minimal()
SeuGrafico
####### Grafico B - Grafico para comparar grupos partindo de dados de 2 variáveis
# Importar tabela
TabelaDados<-tabela1
TabelaDados$Covid19PCR<-factor(TabelaDados$Covid19PCR)
TabelaDados$Sexo<-factor(TabelaDados$Sexo)
str(TabelaDados)
CatCovid19PCR<-levels(TabelaDados$Covid19PCR)
CatSexo<-levels(TabelaDados$Sexo)
cell1<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[1]&TabelaDados$Sexo==CatSexo[1])
cell2<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[2]&TabelaDados$Sexo==CatSexo[1])
cell3<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[1]&TabelaDados$Sexo==CatSexo[2])
cell4<- subset(TabelaDados, TabelaDados$Covid19PCR==CatCovid19PCR[2]&TabelaDados$Sexo==CatSexo[2])
a <- describe(cell1$Glicose)
b <- describe(cell2$Glicose)
c <- describe(cell3$Glicose)
d <- describe(cell4$Glicose)
DadoParaGrafico <- data.frame(Covid19PCR = c(CatCovid19PCR[1],CatCovid19PCR[2],CatCovid19PCR[1],CatCovid19PCR[2]),
Sexo = c(CatSexo[1],CatSexo[1],CatSexo[2],CatSexo[2]),
Media = c(a$mean,b$mean,c$mean,d$mean),
Erros = c(a$se,b$se,c$se,d$se))
SeuGrafico <- ggplot(data=DadoParaGrafico, aes(x = Covid19PCR, y=Media, fill =Sexo ))
SeuGrafico <- SeuGrafico + geom_bar(stat="identity", position = position_dodge()) +
geom_errorbar(aes(ymin=Media-1.96*Erros, ymax=Media+1.96*Erros), width=.65,
position=position_dodge(.9)) +
labs(x="Sexo", y = "Glicose ")+
scale_fill_brewer(palette="Paired") + theme_minimal()
SeuGrafico
# Obs
# scale_fill_brewer(palette="Green") Define as cores das barras
# theme_minimal deixa o fundo branco
